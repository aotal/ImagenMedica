---
title: "LARGE LANGUAGE MODELS (LLM) APLICADOS AL ENTORNO MÉDICO"
date: "2025-02-10"
categories: [Presentación]
image: img/portada_llm.png
author: "[Antonio Otal Palacín](antonio.otal@udl.cat)"
institute: Hospital Universitari Arnau de Vilanova (Lleida)
lang: es
format: 
    revealjs:
        logo: 'https://cdn0.iconfinder.com/data/icons/modern-ui-glyph-1/64/modern-ui-glyph-1-03-512.png'
        footer-logo-link: "/"
        footer: "[IAMED](https://cv.udl.cat/portal/site/100794-2324/tool/3d5c2c81-a50b-43ce-a0bf-ecbfd152350b)"
        css: styles.css
        number-sections: false
        slide-number: false
        center: false
filters:
  - reveal-header        
jupyter: python3   
---

## Índice

-   Introducción breve a los LLM
-   Embedding Systems
-   Fine-Tuning y Retrieval Augmentation Generation (RAG)
-   Ejemplo de RAG según la estructuración de los datos
-   Knowledge Graphs
-   Límites de los LLM

::: notes
Notes
:::

# Introducción breve a los LLM

::: notes
Notes
:::

## LLM

![](img/llm.gif){fig-align="center"}

::: notes
Notes
:::

## LLM Pretraining

A una velocidad de 1000 millones de operaciones por segundo entrenar a GPT3 nos costaría 100 millones de años.

Se hubiese tenido que empezar a entrenar el modelo en el cretácico.

::: notes
Notes
:::

## LLM Reinforcement Learning with Human Feedback

![](img/pretraining.gif){fig-align="center"}

::: notes
Notes
:::

## LLM GPU

![](img/gpu.gif){fig-align="center"}

::: notes
Notes
:::

## TRANSFORMERS

::: columns
::: {.column width="20%"}

![](img/transformer.jpg){.absolute top=200left=0 width="200" height="200"}
![](img/qrcode_transformers.png){.absolute top=350 left=0 width="200" height="200"}
![](img/deeplearningai.png){.absolute top=550 left=0 width="200"}

:::

::: {.column width="80%"}
<p style="font-size: 30px;">**Codificaciones posicionales**: Los transformers agregan un número a cada palabra para indicar su posición en la oración. Esto ayuda al modelo a comprender el orden de las palabras, lo cual es crucial para el significado.
</p>
<p style="font-size: 30px;">**Atención**: Permite al modelo considerar todas las palabras de la oración al traducir o analizar una palabra específica. Esto ayuda a capturar relaciones complejas entre palabras y mejora la precisión de la traducción y la comprensión.
</p>
<p style="font-size: 30px;">**Autoatención**: Permite al modelo comprender una palabra en el contexto de las palabras que la rodean, lo que ayuda a desambiguar palabras con múltiples significados y captar matices del lenguaje.
</p>

:::
:::


::: notes
Notes
:::

# Vector Embedding 

## EMBEDDING


<blockquote cite="">
    *Vector embeddings* son representaciones numéricas de información, como texto, documentos, imágenes o audio. Capturan el significado semántico de la información
  </blockquote>



::: notes
Notes
:::

## VECTORES


![](img/vectores.gif)



::: notes
Notes
:::

## Datos estructurados

::: columns
::: {.column width="50%"}
```{python}
import pandas as pd
tb=pd.read_csv('tablas/apple_quality.csv')
tb
```
:::

::: {.column width="50%"}
![](img/DatosEstructurados1.jpg){fig-align="right"}
:::
:::

::: notes
Notes
:::

## Ejemplos de datos estructurados

-   Registros Electrónicos de Salud
-   Datos de Laboratorio Clínico

## Datos no estructurados

::: columns
::: {.column width="50%"}
-   Texto
-   Imágenes
-   Audio
-   Video
-   ...
:::

::: {.column width="50%"}
![](img/DatosNoEstructurados1.jpg)
:::
:::

::: notes
Notes
:::

## Datos semiestructurados

::: columns
::: {.column width="50%"}
![](https://www.diegocalvo.es/wp-content/uploads/2017/11/datos_semiestructurados.png)
:::

::: {.column width="50%"}
![](https://www.dicomstandard.org/images/librariesprovider2/default-album/dicom-logo.jpg?sfvrsn=7e5f288b_2)
:::
:::

::: notes
Notes
:::

## Por naturaleza de los datos

-   Categóricos
-   Numéricos
-   Temporales
-   Espaciales

::: notes
Notes
:::

## Por granularidad de los datos

-   **Datos a nivel de instancia**: Datos individuales que representan observaciones o eventos específicos, como registros de pacientes o imágenes médicas.
-   **Datos a nivel de atributo**: Datos que representan características o atributos de las instancias, como la edad, el peso o los síntomas clínicos.

::: notes
Notes
:::

## Fuente de los datos

-   **Datos primarios**: Datos recopilados directamente de la fuente original, como registros médicos electrónicos (EHR) o resultados de pruebas de laboratorio.

-   **Datos secundarios**: Datos que han sido recopilados o procesados por terceros, como conjuntos de datos disponibles en repositorios públicos o bases de datos comerciales.

::: notes
Notes
:::

## Datos anotados vs no anotados

-   **Estructura semántica**: Los datos anotados tienen metadatos adicionales que proporcionan contexto y significado, como las etiquetas que marcan entidades nombradas.

-   **Interoperabilidad y procesabilidad**: Los datos anotados son más interoperables y procesables, lo que facilita su integración con otros sistemas y su procesamiento automatizado.

-   **Facilidad de búsqueda y recuperación**: Los datos anotados son más fáciles de buscar y recuperar, ya que las anotaciones permiten identificar elementos específicos.

::: notes
Notes
:::

# Anotación de datos

![](https://www.shaip.com/wp-content/uploads/2023/05/Data-Annotation-New-Images-03.jpg)

## ¿Qué es la anotación de datos?

La anotación de datos es el proceso de atribución o etiquetado de datos para ayudar a los algoritmos de aprendizaje automático a comprender y clasificar la información que procesan.

-   Texto
-   Imágenes
-   Audio
-   Video

## Anotación de imágenes

::: columns
::: {.column width="50%"}
-   Clasificación
-   Reconocimiento/Detección
-   Segmentación
:::

::: {.column width="50%"}
![](https://www.shaip.com/wp-content/uploads/2021/08/page-8-1.jpg)

[VGG](https://www.robots.ox.ac.uk/~vgg/software/via/via_demo.html)
:::
:::

## Anotación de audio

![](https://macgence.com/wp-content/uploads/2023/08/Audio-Annotation-801x299.webp)

## Anotación de video

![](https://www.shaip.com/wp-content/uploads/2022/02/page-3.jpg)

## Anotación de texto

::: columns
::: {.column width="50%"}
-   Semántica
-   Intención
-   Opinión

[tabula](http://tabula.ondata.it/)
:::

::: {.column width="50%"}
![](https://www.datasciencecentral.com/wp-content/uploads/2021/10/9489155876.png)
:::
:::

# Privacidad y confidencialidad

![](img/RGPD.png){fig-align="center"}

# Registros electrónicos de salud (EHR)

## Antecedentes

::: columns
::: {.column width="50%"}
![](img/HistoriaClinica1.jpg)
:::

::: {.column width="50%"}
![](img/HistoriaClinica2.jpg)
:::
:::

::: notes
Notes
:::

## Problemas de la historia clínica en papel

-   Accesibilidad limitada

-   Riesgo de pérdida o daño

-   Dificultad para mantener actualizada la información

-   Espacio de almacenamiento y organización

-   Limitaciones en la compartición y colaboración

::: notes
Notes
:::

## Componentes de los EHR

-   Módulos de Registro y Documentación

-   Pedidos y Resultados de laboratorio

-   Gestión de Medicamentos

-   Integración de Imágenes Médicas (PACS)

::: notes
Notes
:::

## SAP 1

![](img/SAP_1.png)

::: notes
Notes
:::

## SAP 2

![](img/SAP_2.png)

::: notes
Notes
:::

## SAP 3

![](img/SAP_3.png)

::: notes
Notes
:::

## ARIA

![](img/ARIA.PNG)

::: notes
Notes
:::

# Preprocesado de datos médicos

![](img/ProcesadoDeDatos1.png){fig-align="center"}

::: notes
Notes
:::

## Limpieza de datos

-   Eliminación de observaciones incompletas
-   Imputación de valores
-   Análisis de patrones de datos faltantes
-   Uso de modelos predictivos
-   Técnicas de imputación múltiple

::: notes
Notes
:::

## Normalización de variables continuas

-   Las variables continuas pueden tener diferentes escalas y rangos de valores
-   La normalización ayuda a mitigar este problema al transformar las variables para que estén en una escala similar

::: notes
Notes
:::

## Técnicas de normalización

-   Datos con una media de 0 y desviación estándar 1
-   Normalización min-max (0-1)
-   Puede mejorar la convergencia

::: callout-warning
Es importante aplicar la misma transformación de normalización tanto al conjunto de entrenamiento como al conjunto de prueba para evitar sesgos en los datos.
:::

::: notes
Notes
:::

## Integración de datos

-   Fuentes de Datos Diversas
-   Resolución de inconsistencias
-   Limpieza de Datos
-   Gestión de Datos Temporales

::: notes
Notes
:::

## La ingeniería de características

-   Creación de Nuevas características
-   Selección de Características Relevantes

::: notes
Por ejemplo el índice de masa corporal
:::

## Anonimización de los datos

-   La anonimización es el proceso de eliminar o modificar datos personales de tal manera que ya no sea posible identificar a un individuo a partir de los datos.

-   La anonimización está vinculada a lo que dicen las leyes de protección de datos en la UE (RGPD)

::: notes
Notes
:::

## Técnicas de anonimización

-   Eliminación de identificadores directos
-   Pseudonimización
-   Enmascaramiento
-   Agregación

::: notes
Notes
:::

## Consideraciones al elegir una técnica de anonimización

-   El tipo de datos que se procesan
-   El nivel de riesgo de reidentificación
-   Los fines para los que se utilizarán los datos anonimizados

::: notes
Notes
:::

## *Data Augmentation*

Es una técnica que consiste en crear nuevas muestras de datos a partir de datos existentes. Estas nuevas muestras se generan mediante la aplicación de transformaciones predefinidas a los datos originales

![](https://dawn.cs.stanford.edu/assets/img/2017-08-11-tanda/data_aug_basic.png)

::: notes
Notes
:::

## Ventajas de *Data Augmentation*

-   Aumenta el tamaño del conjunto de datos
-   Mejora la generalización del modelo
-   Reduce el sesgo del modelo

::: notes
Notes
:::

## *Data Augmentation* en imágenes médicas

-   Rotaciones
-   Zoom
-   Cambio de contraste
-   Adición de ruido
-   Simulación de artefactos

::: notes
Notes
:::

## *Data Augmentation* en señales biomédicas

Como el Electrocardiograma o el Electroencefalograma

-   Adición de ruido
-   Cambio de escala
-   Segmentación de señales
-   Simulación de artefactos

# Vectorizaciones (*Embeddings*)

## Ángulo entre dos vectores

![](https://www.mathsisfun.com/algebra/images/dot-product-ex2.gif){fig-align="center"}

## ¿Qué son las vectorizaciones?

![](https://daleonai.com/images/word2vec.png){fig-align="center"}

## Práctica

[Notebook](https://colab.research.google.com/drive/17hAP1ePCEOxDMREzNHQi1SwT0FYNa42n?usp=sharing)

[juego](https://colab.research.google.com/drive/1r3e5MLJ7KuIF55yXr4L4bWxSh5udQ9rx?usp=sharing)